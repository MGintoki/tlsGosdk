package gosdk

import (
	"github.com/dgrijalva/jwt-go"
	"io"
)

const VERSION = "0.2.4"

/**
 * UA标识
 */
const USER_AGENT = "ITFARM-GO-CLIENT"

/**
 * 最大并发数
 */
const MAX_CONCURRENCY = 512

/**
 * 默认并发送
 */
const DEFAULT_CONCURRENCY = 5

/**
 * 默认连接超时时间
 */
const CONNECT_TIMEOUT = 2.0

/**
 * 默认请求超时时间
 */
const TIMEOUT = 3.0

//密钥过期时间
const KEY_TIME_OUT = 86400

/*
 * 支持的请求方法
 */
//const ALLOW_METHODS[7] ={"get", "delete", "head", "options", "patch", "post", "put"}
var ALLOW_METHODS = []string{"get", "delete", "head", "options", "patch", "post", "put"}

const CONTENT_TYPE_FORM = "application/x-www-form-urlencoded"
const CONTENT_TYPE_JSON = "application/json"
const CONTENT_TYPE_MULTIPART = "multipart/form-data"

const GATEWAY_SERVICE_KEY = "GATEWAY_HOST_SERVICE"

const APP_SECRET_MAP_KEY = "APP_SECRETS_MAP"

const DATA_CHANNEL = "IDG_CHANNELS"

const FROM_APPID_KEY = "from_appid"

const FROM_APPKEY_KEY = "from_appkey"

const FROM_CHANNEL_KEY = "from_channel"

const TO_APPID_KEY = "appid"

const TO_APPKEY_KEY = "appkey"

const TO_CHANNEL = "channel"

const TO_CHANNEL_ALIAS = "alias"

const ACCOUNT_ID_KEY = "account_id"

const SUB_ORG_KEY_KEY = "sub_org_key"

const USER_INFO_KEY = "user_info"

const CALL_STACK_KEY = "call_stack"

const DEFAULT_CHANNEL_ALIAS = "test"

const ISS = "ItfarmGoSdk"

const (
	KONG_PROXY = "KONG_PROXY"
	/*HEADER_APPID   = "x-appid"
	HEADER_APPKEY  = "x-appkey"
	HEADER_CHANNEL = "x-channel"*/
	// 读取请求头
	SELF_APPID_KEY   = "x-appid" // X-Appid
	SELF_APPKEY_KEY  = "x-appkey"
	SELF_CHANNEL_KEY = "x-channel"

	REGISTER_APPID = "xrpkalflbedhowhju6cqszg0p73zd8qu"
)

type fileStruct struct {
	fileKey  string
	fileName string
	file     io.Reader
}

type MyClaimsForRequest struct {
	FromAppid   string              `json:"from_appid"`
	FromAppkey  string              `json:"from_appkey"`
	FromChannel string              `json:"from_channel"`
	Appid       string              `json:"appid"`
	Appkey      string              `json:"appkey"`
	Channel     string              `json:"channel"`
	Alias       string              `json:"alias"`
	AccountId   string              `json:"account_id"`
	SubOrgKey   string              `json:"sub_org_key"`
	UserInfo    map[string]string   `json:"user_info"`
	CallStack   []map[string]string `json:"call_stack"`
	jwt.StandardClaims
}

type MyClaimsForChainRequest struct {
	AccountId string              `json:"account_id"`
	SubOrgKey string              `json:"sub_org_key"`
	UserInfo  map[string]string   `json:"user_info"`
	CallStack []map[string]string `json:"call_stack"`
	jwt.StandardClaims
}

const (
	TestCert = `-----BEGIN CERTIFICATE-----
MIIDxDCCAqygAwIBAgIQRDF1g18zQVi325FRf9aN/TANBgkqhkiG9w0BAQsFADBe
MQswCQYDVQQGEwJDTjEOMAwGA1UEChMFTXlTU0wxKzApBgNVBAsTIk15U1NMIFRl
c3QgUlNBIC0gRm9yIHRlc3QgdXNlIG9ubHkxEjAQBgNVBAMTCU15U1NMLmNvbTAe
Fw0yMDA0MjgwNzQ5NDdaFw0yMTA0MjgwNzQ5NDdaMBwxCzAJBgNVBAYTAkNOMQ0w
CwYDVQQDEwR0ZXN0MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA89pZ
ATcqBotIMQzDmQK+gPas7Se8FOOb9+NkDUvolEatIJ5RJh42ek0uJVSnnkareW1F
sSQgQWlgQjyyaFlHmvD2FE7TK9UwkgXtqQpn18oIfaETpbgBbtC663jHBzTQnrCr
c4rx4DwO65FYv8ph98X2Wh3eanUBCl5rsWugoMAqPN1QwIIOFopNos9IyEnIcf5A
XIaU3e03yie9kDr1fo8XCUGEfdJEWwJozPiPlWYH8y9bqyRsPwOxKk7KSvxGdeax
rFgHAuu+vlUh7SeE9HFRySCOpS0Tg/WWEBEuf4p/g6tnpDebEm40Ilyx2ujXFJ0N
oT1cnHASLtNxI6XMKwIDAQABo4G/MIG8MA4GA1UdDwEB/wQEAwIHgDATBgNVHSUE
DDAKBggrBgEFBQcDAjAfBgNVHSMEGDAWgBQogSYF0TQaP8FzD7uTzxUcPwO/fzBj
BggrBgEFBQcBAQRXMFUwIQYIKwYBBQUHMAGGFWh0dHA6Ly9vY3NwLm15c3NsLmNv
bTAwBggrBgEFBQcwAoYkaHR0cDovL2NhLm15c3NsLmNvbS9teXNzbHRlc3Ryc2Eu
Y3J0MA8GA1UdEQQIMAaCBHRlc3QwDQYJKoZIhvcNAQELBQADggEBAKBhaTHYWHWm
zohQnbxNcZ52MU0sAMD9WY/WNh4sYFL293AxBmPJpb1FxEYx515YR9507awrWoIO
bsH9vfnCp+G7LHfbADSIIB9181eMsdxrp3LH3rqFYDMZxPnUt82nGAxA5BuJz2uC
AAxxmwCo2CoUCL+5X3eH9rkQHEJ0VFGHypQJUa/ZsKQdLwq23xBVgMGpIJ4JBGIr
ZlDMy3BAEGtIr+zOgNDCAIYEL0V6e178ZsqnMO+Gl+t/6FZjQ9sCry5AyGgiXeCb
jS4VRnINRXNMfU9GgNhJ+RaI+XumjPwYuVzdHWSgRkzTUgagKQTA5/pg74o/91PO
yInoGUDcylg=
-----END CERTIFICATE-----
`
	TestPrivateKey = `-----BEGIN RSA PRIVATE KEY-----
MIIEpQIBAAKCAQEA89pZATcqBotIMQzDmQK+gPas7Se8FOOb9+NkDUvolEatIJ5R
Jh42ek0uJVSnnkareW1FsSQgQWlgQjyyaFlHmvD2FE7TK9UwkgXtqQpn18oIfaET
pbgBbtC663jHBzTQnrCrc4rx4DwO65FYv8ph98X2Wh3eanUBCl5rsWugoMAqPN1Q
wIIOFopNos9IyEnIcf5AXIaU3e03yie9kDr1fo8XCUGEfdJEWwJozPiPlWYH8y9b
qyRsPwOxKk7KSvxGdeaxrFgHAuu+vlUh7SeE9HFRySCOpS0Tg/WWEBEuf4p/g6tn
pDebEm40Ilyx2ujXFJ0NoT1cnHASLtNxI6XMKwIDAQABAoIBAQDJoewikyiOzLBe
zn0Vki1PmaiXWFmutB2NNVrPm8qugFo7NG1JJYZKTnMvrvYCa9Dx0KbluEdrjuRn
IKUsn1YUCdaQKDV4cwl8VKaVNeNzjLzElGIYjzOwG6vTdMStcsBl1xONsIAbt81m
f4Jw47lqFSiEj1oPkLvRhQ1rYOEqyN1ySy4uGRbs5Jg1888dtoEuuqxfL1V5VwmN
9/v77rsySIwc5GTsKRlApac04tfIMX7FrD5kKeXzrDizQTP+g5grxl2jry9lKHpf
qwSGkJz0sXzgvIbc1lcGVvWFL1S7NgtAnk61zUzut9EpAH+l1c2SUu7si0LiW9j6
BTmxV3NxAoGBAPlOkYTemtGHhMrGAmNfP/ULZdIp98+2qo3ya6Qvvb9jE0SVr9h0
EZgfbeXB52bFahJuz9/9n3XpEWnh6W44A7ESHbMTQt5t4OHemG3NL82dWEsbb8zB
x97tCn3m4ZtGAqTwtYPgucMBGU9HSwFWtUrk5inRRmekHYscqW40dpwNAoGBAPpm
S5FCcHoRGQHTSTEtkEKx9vbd7mSDe3PcNLmZu4ulm9JGSmoO9WC5PzHrCYp+LOMM
uaNNQmYcQ5tr/OdLk84vpbBxIbD02SElcIzGYi5hwNaYaAlDZKh4DQ+7fN8cRA0S
X0ALR3weC5+bEX9bDCRNatNf+U2C4JgurY0aSCMXAoGBAKOvX0HCuhl6Bcjwyt6d
yitEaXzcSzVYtJBwKxZotgdzsFHmicbvJiIf+JLShfDnCubBVMC3D7xl4yYGyrGw
G1RmFZPewJezwuPpt2DYSFuSxEbD49qnHGiUb8AMF/JPvCq5VCQbJzwOe6SepXNi
j7N1qFyqZ7Rif3c3wVJ3Jaz9AoGBAKD8mcMHezcPvQsuY1VJ3QD0WDp5jyZyXjGs
Nv3I+AodbGQxqvArM9l+4EFgwl6XJpbHfKagKntp2pGXSR8PuTSL77PT2HxjvyGP
Z6Aqf78gPBH8JI8oFBQ4MvWVbgAntRzOXgzX85q52nFACmzeBZ1lZLQHdUo/RdSx
1gTtC8n7AoGAGa8G+w6do6B+HOoApB3AQTgWiBa+tCqT+U3+eKAuB/Ymg47Vhd9a
CKsIToIEn3ZMhTl8k/rDSe3qckVHdr7aJHu6q5YjbNUDrpiQMCJUxjMbydGQYfeS
1MVKwjO3LHd4SdetB7Xwns4qKET7r989iQt9hDIVCSQf/4KbjwQ8CSc=
-----END RSA PRIVATE KEY-----
`
	TestPublicKey = `-----BEGIN PUBLIC KEY-----
MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA89pZATcqBotIMQzDmQK+
gPas7Se8FOOb9+NkDUvolEatIJ5RJh42ek0uJVSnnkareW1FsSQgQWlgQjyyaFlH
mvD2FE7TK9UwkgXtqQpn18oIfaETpbgBbtC663jHBzTQnrCrc4rx4DwO65FYv8ph
98X2Wh3eanUBCl5rsWugoMAqPN1QwIIOFopNos9IyEnIcf5AXIaU3e03yie9kDr1
fo8XCUGEfdJEWwJozPiPlWYH8y9bqyRsPwOxKk7KSvxGdeaxrFgHAuu+vlUh7SeE
9HFRySCOpS0Tg/WWEBEuf4p/g6tnpDebEm40Ilyx2ujXFJ0NoT1cnHASLtNxI6XM
KwIDAQAB
-----END PUBLIC KEY-----
`
	TestChain = `-----BEGIN CERTIFICATE-----
MIIDxDCCAqygAwIBAgIQRDF1g18zQVi325FRf9aN/TANBgkqhkiG9w0BAQsFADBe
MQswCQYDVQQGEwJDTjEOMAwGA1UEChMFTXlTU0wxKzApBgNVBAsTIk15U1NMIFRl
c3QgUlNBIC0gRm9yIHRlc3QgdXNlIG9ubHkxEjAQBgNVBAMTCU15U1NMLmNvbTAe
Fw0yMDA0MjgwNzQ5NDdaFw0yMTA0MjgwNzQ5NDdaMBwxCzAJBgNVBAYTAkNOMQ0w
CwYDVQQDEwR0ZXN0MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA89pZ
ATcqBotIMQzDmQK+gPas7Se8FOOb9+NkDUvolEatIJ5RJh42ek0uJVSnnkareW1F
sSQgQWlgQjyyaFlHmvD2FE7TK9UwkgXtqQpn18oIfaETpbgBbtC663jHBzTQnrCr
c4rx4DwO65FYv8ph98X2Wh3eanUBCl5rsWugoMAqPN1QwIIOFopNos9IyEnIcf5A
XIaU3e03yie9kDr1fo8XCUGEfdJEWwJozPiPlWYH8y9bqyRsPwOxKk7KSvxGdeax
rFgHAuu+vlUh7SeE9HFRySCOpS0Tg/WWEBEuf4p/g6tnpDebEm40Ilyx2ujXFJ0N
oT1cnHASLtNxI6XMKwIDAQABo4G/MIG8MA4GA1UdDwEB/wQEAwIHgDATBgNVHSUE
DDAKBggrBgEFBQcDAjAfBgNVHSMEGDAWgBQogSYF0TQaP8FzD7uTzxUcPwO/fzBj
BggrBgEFBQcBAQRXMFUwIQYIKwYBBQUHMAGGFWh0dHA6Ly9vY3NwLm15c3NsLmNv
bTAwBggrBgEFBQcwAoYkaHR0cDovL2NhLm15c3NsLmNvbS9teXNzbHRlc3Ryc2Eu
Y3J0MA8GA1UdEQQIMAaCBHRlc3QwDQYJKoZIhvcNAQELBQADggEBAKBhaTHYWHWm
zohQnbxNcZ52MU0sAMD9WY/WNh4sYFL293AxBmPJpb1FxEYx515YR9507awrWoIO
bsH9vfnCp+G7LHfbADSIIB9181eMsdxrp3LH3rqFYDMZxPnUt82nGAxA5BuJz2uC
AAxxmwCo2CoUCL+5X3eH9rkQHEJ0VFGHypQJUa/ZsKQdLwq23xBVgMGpIJ4JBGIr
ZlDMy3BAEGtIr+zOgNDCAIYEL0V6e178ZsqnMO+Gl+t/6FZjQ9sCry5AyGgiXeCb
jS4VRnINRXNMfU9GgNhJ+RaI+XumjPwYuVzdHWSgRkzTUgagKQTA5/pg74o/91PO
yInoGUDcylg=
-----END CERTIFICATE-----
-----BEGIN CERTIFICATE-----
MIIDuzCCAqOgAwIBAgIQSEIWDPfWTDKZcWNyL2O+fjANBgkqhkiG9w0BAQsFADBf
MQswCQYDVQQGEwJDTjEOMAwGA1UEChMFTXlTU0wxLDAqBgNVBAsTI015U1NMIFRl
c3QgUm9vdCAtIEZvciB0ZXN0IHVzZSBvbmx5MRIwEAYDVQQDEwlNeVNTTC5jb20w
HhcNMTcxMTE2MDUzNTM1WhcNMjcxMTE2MDUzNTM1WjBeMQswCQYDVQQGEwJDTjEO
MAwGA1UEChMFTXlTU0wxKzApBgNVBAsTIk15U1NMIFRlc3QgUlNBIC0gRm9yIHRl
c3QgdXNlIG9ubHkxEjAQBgNVBAMTCU15U1NMLmNvbTCCASIwDQYJKoZIhvcNAQEB
BQADggEPADCCAQoCggEBAMBOtZk0uzdG4dcIIdcAdSSYDbua0Bdd6N6s4hZaCOup
q7G7lwXkCyViTYAFa3wZ0BMQ4Bl9Q4j82R5IaoqG7WRIklwYnQh4gZ14uRde6Mr8
yzvPRbAXKVoVh4NPqpE6jWMTP38mh94bKc+ITAE5QBRhCTQ0ah2Hq846ZiDAj6sY
hMJuhUWegVGd0vh0rvtzvYNx7NGyxzoj6MxkDiYfFiuBhF2R9Tmq2UW9KCZkEBVL
Q/YKQuvZZKFqR7WUU8GpCwzUm1FZbKtaCyRRvzLa5otghU2teKS5SKVI+Tpxvasp
fu4eXBvveMgyWwDpKlzLCLgvoC9YNpbmdiVxNNkjwNsCAwEAAaN0MHIwDgYDVR0P
AQH/BAQDAgGGMA8GA1UdJQQIMAYGBFUdJQAwDwYDVR0TAQH/BAUwAwEB/zAfBgNV
HSMEGDAWgBSa8Z+5JRISiexzGLmXvMX4oAp+UzAdBgNVHQ4EFgQUKIEmBdE0Gj/B
cw+7k88VHD8Dv38wDQYJKoZIhvcNAQELBQADggEBAEl01ufit9rUeL5kZ31ox2vq
648azH/r/GR1S+mXci0Mg6RrDdLzUO7VSf0JULJf98oEPr9fpIZuRTyWcxiP4yh0
wVd35OIQBTToLrMOWYWuApU4/YLKvg4A86h577kuYeSsWyf5kk0ngXsL1AFMqjOk
Tc7p8PuW68S5/88Pe+Bq3sAaG3U5rousiTIpoN/osq+GyXisgv5jd2M4YBtl/NlD
ppZs5LAOjct+Aaofhc5rNysonKjkd44K2cgBkbpOMj0dbVNKyL2/2I0zyY1FU2Mk
URUHyMW5Qd5Q9g6Y4sDOIm6It9TF7EjpwMs42R30agcRYzuUsN72ZFBYFJwnBX8=
-----END CERTIFICATE-----`
)

const (
	PRIVATE_KEY = `-----BEGIN  WUMAN RSA PRIVATE KEY -----
MIIEpQIBAAKCAQEArDuxlkVpBB4zPoNzBh9F0OLeR8kk/8/ewryuVlj2/SM5gLaN
I8jXt1Fpc9nNBMZlqNttZyf+h0PA9N2QDLhhLreB566m+H4TrobaRfrhe2ZQG/E2
8XuebqcWRLsqOBc/6ydywcpmk3JSlIMYCLzTM1p1XlA1mrJPc7GlDKCRcUiPDn+n
Z67n2dbXqrpDCykNh3gAFNIrD4vCuB5LEcW8NLGMSBW8/zOxNdeC3S+8ni6HjXsj
Wft85zlcvoe0nGgsPITa0PGBSC/BIVZwYCW7A0+CrDSvVGp9QPuQhdCyf6INduHp
INzeoz7RS2rqoo0ERgctwn62vL7mOnubAruJnwIDAQABAoIBAQCOcG/WD2Fifndy
49Nk5MggkP+z7q4iwg9AjjrAPqNFhrQvtsnTJm8AtNu5bA8aO9onZBF+lpzx0R7r
Y7GWU4ZL1Igiy1ZbfCla1Tv/VBTWsS7fbQY7gDju2lCYVxH7gX7jQ6SskG900b9q
A2EFGOSyO8WFUmCCp6T90ZTmdITUYgk8iNO2bhte0ypHVef3MUrxAu6YnQUIrFIA
zP+Aq09He68ddun38uymOrIpglL5c9pQBpMLZCz866kYfHiyGbGEUyJ60rpqj6u8
1GHDIxtpM9ltwig8nygwrDmkkJw+t1QkxhIPMNbI9B7S/lzMFIZG25puWdoOg5K+
El5zRbBBAoGBAOOQtxYWKQLIDPvddbdGD3qA9J3gAOlGUO8l4V558i+aCdfwZ9NX
O744TvqlMc4P3BrqAt5naKo4tV8mxHz7bo846Y/zOAj/eO72s3Acrn0H6Pmakndn
2TIvl04m6cqoIISoorBuN9KwUImhzar1+0xxuMK2yjChGQivb4wSuC9bAoGBAMHB
CGMSaW73Cv8VBb+9RbLBOUmD7JZcqg5ENvPb50YVEVKpCre/CF1G4QZnbg85FRR3
LjG+NLJBk1dQn4EEE44iwhEGgj1jdO4lCziuJoAWTsFwHpTiJDhdW78ZNsgHejC+
tNrQB0y+Uah5c06p4VJu/kSbr/MoFzenqiva3wYNAoGBAIbZ1uTrtNnFGoyWK4+z
oLCDgnGbsG6MEKHm3KpTsUSsD3E7MQt4Ahsy2vqEsgLeOxxn19NbjBZzDGeaXY2C
oX2VyDJZerc6TLuuzZ5+IJhO+6wOAQVpMLggo5TYUmqZPsvd8qqCZeogOVmV3H6W
zZf7O/WGxEIU9PTEoWFsJmFJAoGAFpD1+hv93ae2Rylapw9TW9N3aaGM36JhSBIX
2GUnVZlEkD0R+36rabnEoatQPUOnud97qN1/Y7eRgpzoRu2DnY1czwDUEHRR/R6h
ZPObllWCzLLTTQHduBbfha1ZHQkJ6T188PNDtmOAPUAP9vyAOsqkoLcFUiu8MIY9
oqf2S80CgYEAppFtMX0bCbBZJwMWY4oskk1IC4y99ogEL0itMGOyxcaVffKRJtkD
v3jylXAUVxu55chy0rbPe4jtgDx/E5k1ZkTNTytOoB1VGblmuGtKWYQe3ITS6V0x
ss2ih/aaR47pzNvK5Z6G/AKtkAy6EubKKGBgMfg+9iiX/IbweFvvb7Y=
-----END  WUMAN RSA PRIVATE KEY -----`
	PUBLIC_KEY = `-----BEGIN  WUMAN  RSA PUBLIC KEY -----
MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEArDuxlkVpBB4zPoNzBh9F
0OLeR8kk/8/ewryuVlj2/SM5gLaNI8jXt1Fpc9nNBMZlqNttZyf+h0PA9N2QDLhh
LreB566m+H4TrobaRfrhe2ZQG/E28XuebqcWRLsqOBc/6ydywcpmk3JSlIMYCLzT
M1p1XlA1mrJPc7GlDKCRcUiPDn+nZ67n2dbXqrpDCykNh3gAFNIrD4vCuB5LEcW8
NLGMSBW8/zOxNdeC3S+8ni6HjXsjWft85zlcvoe0nGgsPITa0PGBSC/BIVZwYCW7
A0+CrDSvVGp9QPuQhdCyf6INduHpINzeoz7RS2rqoo0ERgctwn62vL7mOnubAruJ
nwIDAQAB
-----END  WUMAN  RSA PUBLIC KEY -----`
	CERT = ``
)
